import numpy as np
import json
from scipy.interpolate import interp1d

# 原始数据（MeV）
data_mev = {
    "water": {
        "1.00000E-03": 4.078E+03,
        "1.50000E-03": 1.376E+03,
        "2.00000E-03": 6.173E+02,
        "3.00000E-03": 1.929E+02,
        "4.00000E-03": 8.278E+01,
        "5.00000E-03": 4.258E+01,
        "6.00000E-03": 2.464E+01,
        "8.00000E-03": 1.037E+01,
        "1.00000E-02": 5.329E+00,
        "1.50000E-02": 1.673E+00,
        "2.00000E-02": 8.096E-01,
        "3.00000E-02": 3.756E-01,
        "4.00000E-02": 2.683E-01,
        "5.00000E-02": 2.269E-01,
        "6.00000E-02": 2.059E-01,
        "8.00000E-02": 1.837E-01,
        "1.00000E-01": 1.707E-01,
        "1.50000E-01": 1.505E-01,
        "2.00000E-01": 1.370E-01,
        "3.00000E-01": 1.186E-01,
        "4.00000E-01": 1.061E-01,
        "5.00000E-01": 9.687E-02,
        "6.00000E-01": 8.956E-02,
        "8.00000E-01": 7.865E-02,
        "1.00000E+00": 7.072E-02,
        "1.25000E+00": 6.323E-02,
        "1.50000E+00": 5.754E-02,
        "2.00000E+00": 4.942E-02,
        "3.00000E+00": 3.969E-02,
        "4.00000E+00": 3.403E-02,
        "5.00000E+00": 3.031E-02,
        "6.00000E+00": 2.770E-02,
        "8.00000E+00": 2.429E-02,
        "1.00000E+01": 2.219E-02,
        "1.50000E+01": 1.941E-02,
        "2.00000E+01": 1.813E-02
    },
    "air": {
        "1.00000E-03": 3.606E+03,
        "1.50000E-03": 1.191E+03,
        "2.00000E-03": 5.279E+02,
        "3.00000E-03": 1.625E+02,
        "3.20290E-03": 1.340E+02,
        "4.00000E-03": 7.788E+01,
        "5.00000E-03": 4.027E+01,
        "6.00000E-03": 2.341E+01,
        "8.00000E-03": 9.921E+00,
        "1.00000E-02": 5.120E+00,
        "1.50000E-02": 1.614E+00,
        "2.00000E-02": 7.779E-01,
        "3.00000E-02": 3.538E-01,
        "4.00000E-02": 2.485E-01,
        "5.00000E-02": 2.080E-01,
        "6.00000E-02": 1.875E-01,
        "8.00000E-02": 1.662E-01,
        "1.00000E-01": 1.541E-01,
        "1.50000E-01": 1.356E-01,
        "2.00000E-01": 1.233E-01,
        "3.00000E-01": 1.067E-01,
        "4.00000E-01": 9.549E-02,
        "5.00000E-01": 8.712E-02,
        "6.00000E-01": 8.055E-02,
        "8.00000E-01": 7.074E-02,
        "1.00000E+00": 6.358E-02,
        "1.25000E+00": 5.687E-02,
        "1.50000E+00": 5.175E-02,
        "2.00000E+00": 4.447E-02,
        "3.00000E+00": 3.581E-02,
        "4.00000E+00": 3.079E-02,
        "5.00000E+00": 2.751E-02,
        "6.00000E+00": 2.522E-02,
        "8.00000E+00": 2.225E-02,
        "1.00000E+01": 2.045E-02,
        "1.50000E+01": 1.810E-02,
        "2.00000E+01": 1.705E-02
    }
}

# 将MeV转换为keV
data_kev = {key: {float(k) * 1e3: v for k, v in value.items()} for key, value in data_mev.items()}

# 进行插值
energies_kev = np.linspace(1, 20000, 20000)  # 1 keV 到 20000 keV

interpolated_data = {}
for material, values in data_kev.items():
    energies = np.array(list(values.keys()))
    mu_rho = np.array(list(values.values()))
    interpolation_function = interp1d(energies, mu_rho, kind='cubic', fill_value="extrapolate")
    interpolated_mu_rho = interpolation_function(energies_kev)
    interpolated_data[material] = dict(zip(energies_kev, interpolated_mu_rho))

# 保存为JSON文件
with open('../var/mu_p_data.json', 'w') as json_file:
    json.dump(interpolated_data, json_file, indent=4)

print("插值数据已成功保存为interpolated_mu_p_data.json")
